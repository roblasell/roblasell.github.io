<html>

<head>
  <script>
    //var element = null;
    var circles = [];
    var numObjs = 10;

    var position = 0;

    var myCircle = function (id) {
	this.element = document.createElementNS (NS, "circle");
	this.element.setAttribute("id", id);
	this.element.setAttribute("fill", '#'+(0x1000000+(Math.random())*0xffffff).toString(16).substr(1,6));
	this.element.setAttribute("r", (Math.random() * 50) + 5);
	this.element.setAttribute("xv", Math.random() * 10);
	this.element.setAttribute("yv", Math.random() * 10);

	this.setXY = function (x, y) {
	    this.element.setAttribute("cx", x);
	    this.element.setAttribute("cy", y);
	    
	    return this;
	}

	this.setCB = function () {
	    var cb = function () {
		//console.log(this.element.getAttribute("id"));
		this.element.setAttribute("fill", "#0000FF");
	    }
	    this.element.addEventListener("mouseover", cb.bind(this));
	    
	    var cb2 = function () {
		//console.log("mouseout called");
		this.element.setAttribute("fill", '#'+(0x1000000+(Math.random())*0xffffff).toString(16).substr(1,6));
	    }
	    this.element.addEventListener("mouseout", cb2.bind(this));
	    return this;
	}
    }

    function init() {
	NS ="http://www.w3.org/2000/svg";
	svg = document.createElementNS (NS, "svg");
       
	canvasWidth = 600;
	canvasHeight = 400;
	
	svg.setAttribute ("width", canvasWidth);
	svg.setAttribute ("height", canvasHeight);

	document.body.appendChild(svg);

        for (var i=0; i<numObjs; i++) {
	    var curCircle = new myCircle(i);

	    curCircle.setXY(300, 100+i*10).setCB();

	    circles.push(curCircle);

	    svg.appendChild(curCircle.element);
	}

	window.requestAnimationFrame(draw);
    }


    function draw() {
	for (var i=0; i<numObjs; i++) {
	    if (circles[i] != null) {
	    	var x = parseFloat(circles[i].element.getAttribute("cx")) + parseFloat(circles[i].element.getAttribute("xv"));
			if (x < 0) {
				circles[i].element.setAttribute("xv", -1 * circles[i].element.getAttribute("xv"));
				circles[i].element.setAttribute("cx", 0);
			} else if (x > canvasWidth) {
				circles[i].element.setAttribute("xv", -1 * circles[i].element.getAttribute("xv"));
				circles[i].element.setAttribute("cx", canvasWidth);
			} else {
				circles[i].element.setAttribute("cx", x);
			}
			
			var y = parseFloat(circles[i].element.getAttribute("cy")) + parseFloat(circles[i].element.getAttribute("yv"));
			if (y < 0) {
				circles[i].element.setAttribute("yv", -1 * circles[i].element.getAttribute("yv"));
				circles[i].element.setAttribute("cy", 0);
			} else if (x > canvasHeight) {
				circles[i].element.setAttribute("yv", -1 * circles[i].element.getAttribute("yv"));
				circles[i].element.setAttribute("cy", canvasHeight);
			} else {
				circles[i].element.setAttribute("cy", y);
			}
	    }
	}
	//position = (position + (10) / 10) % 600;
	window.requestAnimationFrame(draw);
    }


  </script>
  
</head>

<body onload="init();">
</body>

</html>
